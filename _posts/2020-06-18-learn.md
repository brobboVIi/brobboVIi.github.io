---
layout: page
title:  "laravel项目的从无到有"
subtitle: "安装一个软件——Postman软件，可以更方便的发送post请求"
date:   2020-06-18 08:21:21 +0530
categories: ["learn"]
---

- 配置网站根目录：因为“路由”并不是真是存在的文件，需要有一个机制“如果文件不存在，url重写指向网站根目录下的index.php”——webServer配置文件，为了达到访问到laravel项目，所以需要将网站根目录设置为laravel项目中的public文件夹（public/）【即不管文件是否存在都会进入laravel项目，因此404错误页面就变成了“Sorry，***”页面，我们可以根据这个来判断是否进入了laravel项目】
    - 排错的时候一定要分清楚是webServer的问题还是laravel项目中的问题，最快捷的方式就是在public/index.php中的第一行写上 echo 111; die; 或者 die("aaaaaaaaaa"); 
- 判断写的是什么项目，分清楚是api项目还是web项目还是混合项目，这个直接关系到我们对于“路由服务提供者”文件【app/Providers/RouteServiceProvider.php】的修改
    -  api项目，就是后段只负责返回数据，不负责将数据与页面整合（数据渲染页面），即前后分离架构，不负责页面，不写v层——mc架构（四层架构Model层 Transfomer层Controller层Service层）【将app/Providers/RouteServiceProvider.php文件中的有关引入routes/web.php路由文件的内容注释掉，同时为了方便删掉api路由前缀】
    - web项目，就是后段也负责页面的渲染，返回的是页面——mvc架构
    - 既有api又有web
- 在api.php中“注册路由”（建立 路由与业务【函数】的关联关系）
    - Route组件中的注册路由方法（Route组件在api.php中不需要引入 因为在路由服务提供者文件中有引入 而api.php是被“复制粘贴”到了路由服务提供者）
        - Route::get()——注册的是get请求的路由
        - Route::post()——注册的是post请求的路由，一般api都是post请求
    - “/” --->"项目健康"，不用建立控制器，直接将一个函数（注册路由方法中的参数2）与路由名进行关联
    - “/test” ----> 测试 路由 控制器 数据库的状况，建立控制器以及model，需要使用字符串作为注册路由方法中的参数2，用于指定某个控制器（类）中的某个成员方法——“ClientController@test”，这就是 ClientController类中的test方法，方法名可以与路由名 不一致，但是为了方便理解，可以设置为一样的名字
- 根据注册的路由映射建立相对应的控制器以及控制器中的方法
    - 在app/Http/Controllers文件夹下建立ClientController.php文件，并且设置该文件的命名空间（App\Http\Controllers）—— 更方便的引入文件
    - 声明类——类名要与文件名一致
    - 该类继承自同一个命名空间下的Controller类（app/Http/Controllers/Controller.php文件）,在同一命名空间下不需要use引入
        - Controller类继承自组件中的Controller类（BaseController类）
        - ClientController--Controller类---BaseController类
        - 我们自己建的controller的共用方法（在以后敲代码的过程中要有意识的进行思考是否是各个/很多控制器都需要用到的方法）要写在Controller类（app/Http/Controllers/Controller.php文件）
    - 并且建立构造方法
    - 声明test函数，public关键字
- 建立Model层（处理数据以及获取数据 每一张表都不一样 但是“也可能”会有一些一样的，所以一张表就是一个model类，并且继承自同一个类）
    - 在app文件夹下新建Models文件夹
    - 在Models文件夹下建立BaseModel.php文件
        - 设置命名空间（App\Models）
        - 声明类 类名与文件名一致 
        - 继承自组件中的Model类（需要引入） use Illuminate\Database\Eloquent\Model; 
        - 建立构造函数
- 在Models文件夹下建立DataClientModel.php文件——data_client表
    - 表名与文件名是有关联的，表名是_形式命名，文件名是“驼峰”式命名，后面再加一个“Model”
    - 设置该文件的命名空间（App\Models）
    - 声明类并且写构造函数 文件名与类名一致
    - 该类继承自自建的BaseModel类（app/Models/BaseModel.php文件）
        - DataClientModel---BaseModel---Model
    - 在类中声明两个属性
        - 表名属性String public $table = "data_client"; 
        - 字段白名单属性Array public $fillable = [数据表中可操作的字段]; 
    - 声明对该表的CURD操作（增删改查）的函数
        - 声明成员方法 getClients，public修饰
        - 在这些函数中调用Model类中的方法从而达到CURD的操作
            - 获取数据get() $this->get(); 
            - return这些数据
- 配置数据库
    - 打开.env文件
    - 修改
        - DB_CONNECTION=mysql
        - DB_HOST=localhost
        - DB_PORT=3306
        - DB_DATABASE=mansys
        - DB_USERNAME=mansys
        - DB_PASSWORD=mansys
- 在ClientController控制器中引入相关model
    - 引入DataClientModel类 use App\Models\DataClientModel; 
    - 在test方法中实例化这个model类 $clientModelObj = new DataClientModel; 
    - 调用该对象中的查询方法 return $clientModelObj->getClients(); 
- 在数据库中添加一条数据 访问test路由，可以看到数据库中的数据